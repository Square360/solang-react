(this["webpackJsonpsolang-react"]=this["webpackJsonpsolang-react"]||[]).push([[0],{53:function(e,a,t){},54:function(e,a,t){},58:function(e,a,t){},60:function(e,a,t){},61:function(e,a,t){},78:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(27),o=t.n(r),s=(t(53),t(23)),l=(t(54),t(9)),i=function(){return Object(l.b)()},u=l.c,p=t(18),f=t(34),d=function(e,a){!function(e,a){var t,n=e.config.alias;Array.isArray(a[n])?(t=a[n],e.hasValue=!0):a[n]?(t=[a[n]],e.hasValue=!0):(t=[],e.hasValue=!1),e.value=t}(e,a)},v=function(e,a){!function(e,a){!0===e.excludeTag?a["facet.field"].push("{!ex=".concat(e.alias,"}").concat(e.solrField)):a["facet.field"].push("".concat(e.solrField));e.sortAlpha&&(a.legacy["f.".concat(e.solrField,".facet.sort")]="index");e.missingLabel&&(a.legacy["f.".concat(e.solrField,".facet.missing")]="true");e.limit&&(a.legacy["f.".concat(e.solrField,".facet.limit")]=e.limit.toString());e.minCount&&(a.legacy["f.".concat(e.solrField,".facet.mincount")]=void 0===e.minCount?"1":e.minCount.toString())}(e.config,a),function(e,a){if(e.value.length>0){var t=!0===e.config.isOr?" OR ":" ",n=e.value.map((function(a){return function(e,a){if(e.missingLabel&&a===e.missingLabel)return function(e){return"(*:* NOT ".concat(e.solrField,":*)")}(e);return"(".concat(e.solrField,':"').concat(a,'")')}(e.config,a)})).join(t);a.fq.push("{!tag='".concat(e.config.alias,"'}").concat(n))}}(e,a)};var y=function(e,a){var t=g(e,a),n={};if(t.value.forEach((function(e){n[e]=0})),e.response&&e.response.facet_counts){var c=t.config.solrField;if(e.response.facet_counts.facet_fields[c]){var r=e.response.facet_counts.facet_fields[c];Object.keys(e.response.facet_counts.facet_fields[c]).forEach((function(e){n[e]=r[e]}))}}return Object.keys(n).map((function(e){return{value:e,count:n[e]}})).sort((function(e,a){return t.config.sortAlpha?e.value<a.value?-1:e.value<a.value?1:0:e.count<a.count?-1:e.count<a.count?1:0}))};var j=function(e,a){var t=e.apps[a];return t||console.log("App ".concat(a," doesn't exist!")),t},b=function(e,a,t){var n=j(e,a);return g(n,t)},g=function(e,a){var t,n=null!==(t=e.filters[a])&&void 0!==t?t:null;return n||console.log("Filter ".concat(a," on app ").concat(e.id," doesn't exist!")),n},h=Object(f.b)({name:"solang",initialState:{config:{},apps:{}},reducers:{createApp:function(e,a){if(e.apps[a.payload.id])throw Error("Solang app ".concat(a.payload.id," already exists!"));e.apps[a.payload.id]=Object(p.a)(Object(p.a)({},a.payload),{},{query:{q:"*",facet:"true","facet.field":[],fq:[],legacy:{},fl:[],start:0,rows:10}})},setParams:function(e,a){var t,n=a.payload.appId,c=e.apps[n];c.params=a.payload.params,(null===c||void 0===c||null===(t=c.config)||void 0===t?void 0:t.setQuery)&&c.config.setQuery(c.params,"push")},setParam:function(e,a){var t,n=a.payload.appId,c=e.apps[n];c.params[a.payload.key]=a.payload.value,(null===c||void 0===c||null===(t=c.config)||void 0===t?void 0:t.setQuery)&&c.config.setQuery(c.params)},buildQuery:function(e,a){console.log("buildQuery reducer",a),console.log("Setting URL params");var t=j(e,a.payload.appId);t.lastQuery=t.query||{},t.query={q:"*",facet:"true","facet.field":[],fq:[],legacy:{},fl:[],start:0,rows:10}},sendQuery:function(e,a){console.log("sendQuery reducer",a)},resultsReceived:function(e,a){console.log("resultsReceived",a),e.apps[a.payload.appId].response=a.payload.response.response},processFacetFilter:function(e,a){var t=j(e,a.payload.appId);t&&(d(t.filters[a.payload.filter],t.params),v(t.filters[a.payload.filter],t.query||{q:"*",facet:"true","facet.field":[],fq:[],legacy:{},fl:[],start:0,rows:10}))},processSimpleFilter:function(e,a){var t=j(e,a.payload.appId);t&&(function(e,a){var t=e.config.alias;Array.isArray(a[t])?(e.value=a[t],e.hasValue=!0):a[t]?(e.value=[a[t]],e.hasValue=!0):(e.value=[],e.hasValue=!1)}(t.filters[a.payload.filter],t.params),function(e,a){var t=e.config.solrField,n="q"===t?"":"".concat(t,":");a.q=e.hasValue?"".concat(n).concat(e.value[0],"*"):"*"}(t.filters[a.payload.filter],t.query||{q:"*",facet:"true","facet.field":[],fq:[],legacy:{},fl:[],start:0,rows:10}))},processPager:function(e,a){var t,n,c=j(e,a.payload.appId);!function(e,a,t){var n,c=g(e,a),r=c.config.alias;n=Array.isArray(t[r])?t[r][0]:t[r]?t[r]:0,c.value="string"===typeof n?parseInt(n):n}(c,a.payload.filter,c.params),t=c.filters[a.payload.filter],(n=c.query||{q:"*",facet:"true","facet.field":[],fq:[],legacy:{},fl:[],start:0,rows:10}).start=t.value*t.config.rows,n.rows=t.config.rows},processSort:function(e,a){var t=j(e,a.payload.appId);!function(e,a,t){var n,c=g(e,a),r=c.config.alias;n=Array.isArray(t[r])?t[r][0]:t[r]?t[r]:"",c.value=n}(t,a.payload.filter,t.params),function(e,a){if(""!==e.value){var t=e.config.options.find((function(a){return a.value===e.value}));t&&(a.sort=t.value)}else if(e.config.default){var n=e.config.options.find((function(a){return a.label===e.config.default}));n&&(a.sort=n.value)}}(t.filters[a.payload.filter],t.query||{q:"*",facet:"true","facet.field":[],fq:[],legacy:{},fl:[],start:0,rows:10})}}}),O=h.actions,m=O.createApp,x=O.setParam,_=O.setParams,I=O.buildQuery,A=O.sendQuery,w=O.resultsReceived,q=O.processFacetFilter,S=O.processSimpleFilter,F=O.processPager,N=O.processSort,Q=h.reducer,k=(t(58),t(1)),C=function(e){return Object(k.jsx)("div",{className:"PrettyPrintJson",children:e.data&&Object(k.jsx)("pre",{children:JSON.stringify(e.data,null,2)})})},E=function(e){var a=e.appId,t=e.alias,n=e.next,c=void 0===n?"Next":n,r=e.prev,o=void 0===r?"Previous":r,s="solang-pager",i=Object(l.b)(),u=Object(l.c)((function(e){return b(e.solang,a,t)})),p=Object(l.c)((function(e){return function(e,a){var t;return(null===(t=j(e,a).response)||void 0===t?void 0:t.response.numFound)||0}(e.solang,a)})),f=u.value,d=Math.ceil(p/u.config.rows),v=f>=d-1,y=f<=0;return Object(k.jsxs)("div",{className:s,children:[!y&&Object(k.jsx)("button",{className:"".concat(s,"__prev"),onClick:function(){var e=(f>0?f-1:0).toString();i(x({appId:a,key:t,value:e}))},children:o}),!v&&Object(k.jsx)("button",{className:"".concat(s,"__next"),onClick:function(){var e=(f<d?f+1:d).toString();i(x({appId:a,key:t,value:e}))},children:c})]})},T=function(e){var a=e.appId,t=e.alias,n="sort-select",c=Object(l.b)(),r=Object(l.c)((function(e){return b(e.solang,a,t)}));return Object(k.jsx)("div",{className:n,children:Object(k.jsx)("select",{className:"".concat(n,"__input"),onChange:function(e){var n=e.currentTarget;c(x({appId:a,key:t,value:n.value}))},children:r.config.options.map((function(e){return Object(k.jsx)("option",{value:e.value,className:"".concat(n,"__input"),children:e.label},e.value)}))})})},P=(t(60),t(45)),R=(t(61),function(e){var a=e.appId,t=e.filterState,n=(e.facetCounts,"facet-cb"),c=Object(l.b)(),r=t.config.alias,o=u((function(e){return j(e.solang,a)})),s=y(o,r),i=function(e){var n=Object(P.a)(t.value),o=e.target.value;e.target.checked&&!n.includes(o)?(n.push(o),c(x({appId:a,key:r,value:n}))):!e.target.checked&&n.includes(o)&&c(x({appId:a,key:r,value:n.filter((function(e){return e!==o}))}))};return Object(k.jsx)("div",{className:"".concat(n),children:Object(k.jsxs)("fieldset",{children:[t.config.label&&Object(k.jsx)("legend",{children:t.config.label}),Object(k.jsx)("ul",{className:"".concat(n,"__list"),children:s.map((function(e,c){return Object(k.jsx)("li",{className:"".concat(n,"__list-item"),children:Object(k.jsxs)("label",{className:"".concat(n,"__label"),children:[Object(k.jsx)("input",{type:"checkbox",checked:t.value.includes(e.value),onChange:i,value:e.value,name:r})," ",Object(k.jsx)("span",{className:"".concat(n,"__value"),children:e.value}),"  ",Object(k.jsxs)("span",{className:"".concat(n,"__count"),children:["(",e.count,")"]})]})},"".concat(a,"--").concat(r,"--").concat(c))}))})]})})}),V=function(){var e,a,t="searchApp",c=i(),r=u((function(e){return j(e.solang,t)})),o=r&&r.response?r.response.response.docs:[],l=r&&r.response&&r.response.facet_counts?r.response.facet_counts:[],f="facet_fields"in l?l.facet_fields.country_s:{},d=u((function(e){var a=j(e.solang,t);return a?a.params.searchText:"undefined"})),v=Object(n.useState)(d),y=Object(s.a)(v,2),b=y[0],h=y[1],O=(null===(e=r.response)||void 0===e?void 0:e.response.start)||0,m=(null===(a=r.response)||void 0===a?void 0:a.response.numFound)||0,x=Math.ceil(O/10);return Object(k.jsxs)("div",{className:"TestSolang",children:[Object(k.jsx)(C,{data:r.params}),Object(k.jsxs)("div",{className:"row",children:[Object(k.jsx)("label",{htmlFor:"val",children:"Param value:"}),Object(k.jsx)("input",{id:"val","aria-label":"Set increment amount",defaultValue:d,onChange:function(e){return h(e.target.value)}}),Object(k.jsx)("button",{"aria-label":"Decrement value",onClick:function(e){e.preventDefault();var a=Object(p.a)({},r.params);a.searchText=b,c(_({appId:t,params:a}))},children:"Set as param"}),Object(k.jsx)("button",{onClick:function(){c(_({appId:t,params:{}}))},children:"Reset"})]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("strong",{children:"Internal param value:"})," ",b]}),Object(k.jsxs)("div",{children:[Object(k.jsx)("strong",{children:"Solang value:"})," ",d]}),Object(k.jsx)(R,{appId:t,filterState:g(r,"country"),facetCounts:f}),Object(k.jsxs)("p",{children:["Showing ",o.length," of ",m," results. Page ",x]}),Object(k.jsx)(T,{appId:t,alias:"sort"}),o&&Object(k.jsx)("ul",{children:o.map((function(e){return Object(k.jsxs)("li",{children:[e.first_name_s," ",e.last_name_s]},e.id)}))}),Object(k.jsx)(E,{appId:t,alias:"page"}),Object(k.jsx)(C,{data:r.query})]})},J=t(10);var L=function(){var e=i(),a=u((function(e){return j(e.solang,"searchApp")})),t=Object(J.d)({searchText:Object(J.e)(J.c,"Dav"),country:Object(J.e)(J.a,[]),city:Object(J.e)(J.a,[]),page:Object(J.e)(J.c,"0"),sort:Object(J.e)(J.c,"")}),n=Object(s.a)(t,2),c=n[0],r=n[1];if(!a){var o={searchText:{config:{solrField:"last_name_t",alias:"searchText"},processQueryActions:[S.type],value:c.searchText||""},country:{config:{solrField:"country_s",alias:"country",label:"Country",minCount:1,sortAlpha:!0,excludeTag:!0},processQueryActions:[q.type],value:c.country},city:{config:{solrField:"city_s",alias:"city",label:"City",sortAlpha:!0,minCount:1},processQueryActions:[q.type],value:c.city},page:{config:{rows:10,alias:"page"},processQueryActions:[F.type],value:c.page||0},sort:{config:{alias:"sort",options:[{label:"Relevance",value:""},{label:"A-Z",value:"last_name_t asc"},{label:"Z-A ",value:"last_name_t desc"}]},processQueryActions:[N.type],value:""}};e(m({id:"searchApp",endpoint:"http://localhost:8983/solr/solang/",config:{setQuery:r},params:c,filters:o}))}return Object(k.jsxs)("div",{className:"App",children:[Object(k.jsx)("header",{className:"App-header",children:Object(k.jsx)("h1",{children:"Solang Test"})}),Object(k.jsx)(V,{})]})},D=t(84),M=t(79),B=t(81),U=t(30),W=t(82),Z=t(83),$=t(85),G=t(86),z=function(e){var a=Object(p.a)({},e);if(a.q||(a.q="*"),a.wt="json",a["json.facet"]&&"object"===typeof a["json.facet"]){var t=JSON.stringify(a["json.facet"]);a["json.facet"]=t}return a.legacy&&(Object.keys(a.legacy).forEach((function(e){a[e]=a.legacy[e]})),delete a.legacy),a["json.nl"]="map",a},H=Object($.a)((function(e,a){return e.pipe(Object(M.a)((function(e){return[_.type,x.type].includes(e.type)})),Object(B.a)((function(e){return console.log("processParamsEpic",e)})),Object(B.a)((function(e){var t,n=j(a.value.solang,e.payload.appId);(null===n||void 0===n||null===(t=n.config)||void 0===t?void 0:t.setQuery)&&n.config.setQuery(n.params)})),Object(U.a)((function(e){return{type:I.type,payload:{appId:e.payload.appId}}})))}),(function(e,a){return e.pipe(Object(M.a)((function(e){return e.type===I.type})),Object(B.a)((function(e){return console.log("buildQueryEpic starting",e)})),Object(W.a)((function(e){var t=j(a.value.solang,e.payload.appId);if(!t)throw new Error("No app ${action.payload.appId} in buildQueryEpic");t.params;var n=[];return Object.keys(t.filters).forEach((function(a){t.filters[a].processQueryActions.forEach((function(t){if(t){var c={type:t,payload:{appId:e.payload.appId,filter:a}};n.push(c)}}))})),n.push({type:A.type,payload:{appId:e.payload.appId,query:{}}}),n})))}),(function(e,a){return e.pipe(Object(Z.a)(A.type),Object(B.a)((function(e){return console.log("sendQueryEpic",e)})),Object(W.a)((function(e){var t=j(a.value.solang,e.payload.appId);if(t)return function(e){var a=Object(p.a)({},e.query),t=z(a),n=new URLSearchParams;Object.entries(t).forEach((function(e){var a=Object(s.a)(e,2),t=a[0],c=a[1];Array.isArray(c)?c.forEach((function(e){return n.append(t,e)})):n.append(t,c)}));var c="".concat(e.endpoint,"select?").concat(n.toString());return Object(G.a)({crossDomain:!0,headers:{"Content-Type":"application/json"},url:c,method:"GET"})}(t).pipe(Object(U.a)((function(a){return{type:w.type,payload:{appId:e.payload.appId,response:a}}})));throw new Error("No solang app!")})))})),K=Object(D.a)(),X=Object(f.a)({reducer:{solang:Q},middleware:[K]});K.run(H);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Y=t(44),ee=t(5);o.a.render(Object(k.jsx)(c.a.StrictMode,{children:Object(k.jsxs)(l.a,{store:X,children:[Object(k.jsx)(Y.a,{children:Object(k.jsx)(J.b,{ReactRouterRoute:ee.a,children:Object(k.jsx)(L,{})})}),","]})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[78,1,2]]]);
//# sourceMappingURL=main.a0d92de4.chunk.js.map